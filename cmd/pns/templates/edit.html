<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>PNS: {{if .Edit}}Edit note #{{.ID}}{{else if .Copy}}Adding copy of note #{{.ID}}{{else}}Add note{{end}}</title>
<link type="text/css" rel="stylesheet" href="/_/static/style.css">
<link type="text/css" rel="stylesheet" href="/_/static/edit.css">
<link rel="stylesheet" href="/_/static/semantic.css" />
<link rel="stylesheet" href="/_/static/awesomplete.css" />
<link rel="icon" href="/_/static/favicon.png" />
<script src="/_/static/awesomplete.js"></script>
<script src="/_/static/pns.js" async></script>
<script>
referer = {{.Referer}};

function setup() {
	newAwesomplete(null);
{{if .EditConflict}}
	setTargetAndAction('preview', 'DiffConflict');
	document.getElementById("form").submit();
{{end}}
}
</script>
</head>

<body class="body" onload="setup();" onkeydown="return editKeyDown(event, referer);">
<form class="edit" action="{{if .Edit}}/_/edit/submit/{{.ID}}{{else}}/_/add/submit{{end}}" method="post" id="form">

<div class="ui borderless top fixed menu">
<div class="left item">
<div class="small ui input">
<input type="text" name="tag" id="tag" placeholder="Topics and tags" class="taginput"
       data-list="{{.TopicsAndTagsComma}}" data-multiple autofocus value="{{.NoteTopicsAndTags}}"></input>
</div>
</div>
<div class="right item">
<div class="small ui buttons">
{{with .Referer}}<input type="button" value="Cancel" class="ui button" onclick="location = referer"></input>{{end}}
<input type="submit" value="Preview" class="ui button" onclick="setTargetAndAction('preview', 'Preview')"></input>
{{if .Edit}}
<input type="submit" value="Diff" class="ui button" onclick="setTargetAndAction('preview', 'Diff')"></input>
{{end}}
<input type="submit" value="Submit" class="ui button" onclick="setTargetAndAction('', 'Submit')"></input>
</div>
</div>
</div>

<input type="hidden" name="action" id="action" value="Preview">
{{if .Edit}}<input type="hidden" name="sha1sum" value="{{.SHA1Sum}}">{{end}}

<div class="content">
<textarea class="edit" name="text" id="text">{{.Text}}</textarea>
<iframe name="preview" src="{{if and (or .Edit .Copy) (not .EditConflict)}}/_/edit/preview/{{.ID}}{{end}}"></iframe>
</div>

</form>
</body>
</html>
